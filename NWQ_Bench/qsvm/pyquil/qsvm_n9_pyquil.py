from pyquil import Program, get_qc
from pyquil.gates import H, CNOT, RZ, MEASURE
from functools import reduce
import numpy as np

shots = 1024

p = Program()

ro = p.declare('ro', memory_type='BIT', memory_size=18)

p.inst(H(0))
p.inst(H(1))
p.inst(H(2))
p.inst(H(3))
p.inst(H(4))
p.inst(H(5))
p.inst(H(6))
p.inst(H(7))
p.inst(H(8))
# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".# Export to pyquil WARNING: unknown gate "p".p.inst(CNOT(0, 1))
p.inst(RZ(2.8311259, 1))
p.inst(CNOT(0, 1))
p.inst(CNOT(1, 2))
p.inst(RZ(1.2265915, 2))
p.inst(CNOT(1, 2))
p.inst(CNOT(2, 3))
p.inst(RZ(1.479296, 3))
p.inst(CNOT(2, 3))
p.inst(CNOT(3, 4))
p.inst(RZ(2.9514659, 4))
p.inst(CNOT(3, 4))
p.inst(CNOT(4, 5))
p.inst(RZ(2.3882589, 5))
p.inst(CNOT(4, 5))
p.inst(CNOT(5, 6))
p.inst(RZ(1.1734905, 6))
p.inst(CNOT(5, 6))
p.inst(CNOT(6, 7))
p.inst(RZ(2.2581292, 7))
p.inst(CNOT(6, 7))
p.inst(CNOT(7, 8))
p.inst(RZ(1.1319911, 8))
p.inst(CNOT(7, 8))
p.inst(CNOT(7, 8))
p.inst(RZ(2.1029369, 8))
p.inst(CNOT(7, 8))
p.inst(CNOT(6, 7))
p.inst(RZ(2.6862292, 8))
p.inst(RZ(2.8882597, 7))
p.inst(H(8))
p.inst(CNOT(6, 7))
p.inst(CNOT(5, 6))
p.inst(RZ(2.6511854, 7))
p.inst(RZ(1.0268664, 6))
p.inst(H(7))
p.inst(CNOT(5, 6))
p.inst(CNOT(4, 5))
p.inst(RZ(0.76967459, 6))
p.inst(RZ(0.55298471, 5))
p.inst(H(6))
p.inst(CNOT(4, 5))
p.inst(CNOT(3, 4))
p.inst(RZ(2.4446613, 5))
p.inst(RZ(0.90856313, 4))
p.inst(H(5))
p.inst(CNOT(3, 4))
p.inst(CNOT(2, 3))
p.inst(RZ(1.9013246, 4))
p.inst(RZ(2.9827742, 3))
p.inst(H(4))
p.inst(CNOT(2, 3))
p.inst(CNOT(1, 2))
p.inst(RZ(0.014797547, 3))
p.inst(RZ(0.19787971, 2))
p.inst(H(3))
p.inst(CNOT(1, 2))
p.inst(CNOT(0, 1))
p.inst(RZ(0.85822507, 2))
p.inst(RZ(0.22373175, 1))
p.inst(H(2))
p.inst(CNOT(0, 1))
p.inst(RZ(0.0041994242, 0))
p.inst(RZ(2.9933554, 1))
p.inst(H(0))
p.inst(H(1))
p.inst(MEASURE(0, ro[9]))
p.inst(MEASURE(1, ro[10]))
p.inst(MEASURE(2, ro[11]))
p.inst(MEASURE(3, ro[12]))
p.inst(MEASURE(4, ro[13]))
p.inst(MEASURE(5, ro[14]))
p.inst(MEASURE(6, ro[15]))
p.inst(MEASURE(7, ro[16]))
p.inst(MEASURE(8, ro[17]))

p.wrap_in_numshots_loop(shots)

qc = get_qc('9q-qvm')
results_list = qc.run(p)
results = list(map(lambda arr: reduce(lambda x, y: str(x) + str(y), arr[::-1], ""), results_list))
counts = dict(zip(results,[results.count(i) for i in results]))
print(counts)
